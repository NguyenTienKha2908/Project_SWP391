<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Production Orders - Sales Staff</title>
    <link rel="stylesheet" href="/css/bootstrap.min.css">
</head>
<body>
    <h1>Production Orders - Sales Staff</h1>
    <table class="table">
        <thead>
            <tr>
                <th>ID</th>
                <th>Customer</th>
                <th>Category</th>
                <th>Material</th>
                <th>Gem</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
            <tr th:each="order : ${listRequests}">
                <td th:text="${order.productionOrderId}"></td>
                <td th:text="${order.customer.fullName}"></td>
                <td th:text="${order.categoryId}"></td>
                <td th:text="${order.materialName}"></td>
                <td th:text="${order.gemName}"></td>
                <td>
                    <button onclick="acceptOrder('[[${order.productionOrderId}]]')">Accept</button>
                    <button onclick="rejectOrder('[[${order.productionOrderId}]]')">Reject</button>
                </td>
            </tr>
        </tbody>
    </table>

    <script>
        function acceptOrder(orderId) {
            fetch(`/production-orders/api/accept-order/${orderId}`, {
                method: "POST",
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json();
            })
            .then(data => {
                console.log("Order accepted:", data);
                location.reload(); // Reload the page to see the updated list
            })
            .catch(error => {
                console.error("Fetch error:", error);
            });
        }

        function rejectOrder(orderId) {
            fetch(`/production-orders/api/reject-order/${orderId}`, {
                method: "POST",
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error("Network response was not ok");
                }
                return response.json();
            })
            .then(data => {
                console.log("Order rejected:", data);
                location.reload(); // Reload the page to see the updated list
            })
            .catch(error => {
                console.error("Fetch error:", error);
            });
        }
    </script>
</body>
</html>
